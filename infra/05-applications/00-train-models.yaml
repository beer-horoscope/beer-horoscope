apiVersion: v1
kind: Pod
metadata:
  name: train-models-job
  annotations:
    argocd.argoproj.io/sync-wave: "0"
spec:
  serviceAccountName: internal-oc-container
  volumes:
  - name: storage
    persistentVolumeClaim:
      claimName: beer-rec-pvc
  containers:
  - name: internal-oc-container
    image: quay.io/kelee/internal-oc-container:latest
    resources:
      requests:
        memory: "50Mi"
      limits:
        memory: "16Gi"
    volumeMounts:
    - mountPath: "/mnt/storage"
      name: storage
    command:
    - sh
    - "-c"
    - |
      /bin/bash <<'EOF'

      cd /home
      mkdir temp
      cd temp
      git clone https://github.com/beer-horoscope/beer-horoscope.git
      cd beer-horoscope
      git checkout smaller-footprint
      
      source scripts/train-models.sh
      EOF
  restartPolicy: Never
        